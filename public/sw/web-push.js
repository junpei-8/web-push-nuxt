var sw=self;console.log("load sw"),sw.addEventListener("push",(function(t){var e,n=null===(e=t.data)||void 0===e?void 0:e.json();if(n){var a=n.title,r=n.body,o=n.icon,i={url:n.url};t.waitUntil(sw.registration.showNotification(a,{body:r,icon:o,data:i}))}}));var targetUrl="",targetMessage=null;sw.addEventListener("notificationclick",(function(t){t.notification.close();var e=sw.clients;t.waitUntil(e.matchAll({type:"window"}).then((function(n){var a=t.notification.data||{},r=targetUrl=sw.location.origin+a.url||"";function o(t){return t&&t.focus?t.focus():Promise.resolve(null)}function i(t){return t&&t.navigate?t.navigate(r):Promise.resolve(null)}for(var s=function(t){var e=n[t];if(e.url===r)return targetMessage="type: focusClient",{value:o(e).then(i).then((function(){return function(t){var e;return null===(e=t.postMessage)||void 0===e||e.call(t,{type:"notification-click",url:r}),Promise.resolve(t)}(e)}))}},l=0;l<n.length;l++){var u=s(l);if("object"==typeof u)return u.value}return targetMessage="type: openWindow",e.openWindow(r).then(o)})))})),sw.addEventListener("message",(function(t){var e;t.source&&targetUrl&&(null===(e=t.source)||void 0===e||e.postMessage({type:"message",message:targetMessage,data:t.data,url:targetUrl}),targetMessage="",targetUrl="")}));