var sw=self;console.log("load sw"),sw.addEventListener("push",(function(t){var e,n=null===(e=t.data)||void 0===e?void 0:e.json();if(n){var a=n.title,r=n.body,i=n.icon,o={url:n.url};t.waitUntil(sw.registration.showNotification(a,{body:r,icon:i,data:o}))}}));var targetClient=null,targetUrl="";sw.addEventListener("notificationclick",(function(t){t.notification.close();var e=sw.clients;t.waitUntil(e.matchAll({type:"window"}).then((function(n){var a=t.notification.data||{},r=targetUrl=sw.location.origin+a.url||"";function i(t){return t&&t.focus?t.focus():Promise.resolve(null)}function o(t){return t&&t.navigate?t.navigate(r):Promise.resolve(null)}for(var l=function(t){var e=n[t];if(e.url===r)return{value:i(e).then(o).then((function(){return function(t){var e;return null===(e=t.postMessage)||void 0===e||e.call(t,{type:"notification-click",url:r}),Promise.resolve(t)}(e)}))}},s=0;s<n.length;s++){var u=l(s);if("object"==typeof u)return u.value}return e.openWindow(r).then(i)})))})),sw.addEventListener("message",(function(t){var e,n;console.log("message From Service Worker: "+JSON.stringify(t.data)),postMessage({type:"message",data:t.data,url:targetUrl}),null===(e=null==targetClient?void 0:targetClient.postMessage)||void 0===e||e.call(targetClient,{type:"message",data:t.data,url:targetUrl}),null===(n=t.source)||void 0===n||n.postMessage({type:"message",data:t.data,url:targetUrl})}));